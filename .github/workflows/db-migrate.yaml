# name: Database Migrations

# on:
#   push:
#     branches:
#       - main
#     paths:
#       - ci_finished.txt

# jobs:
#   migrate:
#     name: 'Run Migrations'
#     runs-on: ubuntu-latest
#     environment: development
#     needs: [run-terraform]

#     steps:
#       - name: Checkout
#         uses: actions/checkout@v4

#       - name: Configure AWS Credentials
#         run: |
#           mkdir -p ~/.aws
#           echo "[lab-academy]
#           aws_access_key_id=${{ vars.AWS_ACCESS_KEY_ID }}
#           aws_secret_access_key=${{ vars.AWS_SECRET_ACCESS_KEY }}
#           aws_session_token=${{ vars.AWS_SESSION_TOKEN }}" > ~/.aws/credentials
      
#       - name: Get RDS Endpoint from SSM
#         id: get-endpoint
#         run: |
#           echo "AWS_RDS_URI=$(aws secretsmanager get-secret-value --secret-id aws_rds_endpoint --query 'SecretString' --output text)" >> $GITHUB_ENV


#       - name: Setup Node.js
#         uses: actions/setup-node@v3
#         with:
#           node-version: '18'

#       - name: Install dependencies
#         run: npm install

#       - name: Run migrations
#         env:
#           DATABASE_URL: "${{ env.AWS_RDS_URI }}"
#         run: npx prisma migrate deploy
